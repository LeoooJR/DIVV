<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VCF comparison report</title>
  <link rel="stylesheet" href="template.css" />
  <link rel="stylesheet" href="file.css" />
  <link rel="stylesheet" href="search.css" />
  <link rel="stylesheet" href="table.css" />
  <link rel="stylesheet" href="cmd.css" />
  <link rel="stylesheet" href="terminal.css" />
  <script src="https://cdn.plot.ly/plotly-3.0.0.min.js" charset="utf-8"></script>
</head>

<body onload="filter()">

    <div class="main">

        <div class="main-left">
            <img src="statics/vcf-left.png" alt="vcf-icon-white" class="header-icon">
            <h2 class="header-left">
              {{ vcfs.repository[0].informations().basename|default(vcfs.repository[0]) }}
            </h2>
        </div>

        <div class="main-right">
            <img src="statics/vcf-right.png" alt="vcf-icon-black" class="header-icon">
            <h2 class="header-right">
              {{ vcfs.repository[1].informations().basename|default(vcfs.repository[1]) }}
            </h2>
        </div>

    </div>

    <div class="sub">

        <div class="sub-left">

            <img src="statics/info-left.png" class="info-icon", id="info-left-icon">

            <div class="info-container">

              <div class="info-bubble">
                <img src="statics/folder.png" class="info-small-icon">
                <p class="info-text-left">
                    {{ vcfs.repository[0].informations().path|default(vcfs.repository[0]) }}
                </p>
              </div>

              <div class="info-bubble">
                <img src="statics/database.png" class="info-small-icon">
                <p class="info-text-left">
                    {{ vcfs.repository[0].informations().size|default('NA') }} Mo
                </p>
              </div>

              <div class="info-bubble">
                <img src="statics/file.png" class="info-small-icon">
                <p class="info-text-left">
                    {{ vcfs.repository[0].informations().mtime|default('NA') }}
                </p>
              </div>

            </div>

            <div style="position: relative; margin-right: 10px; margin-top: 10px;">

              <img src="statics/down-arrow-left.png" class="info-icon" id="dropdown-icon">

              <div class="notification-dot">
                <div class="notification-dot-ping"></div>
              </div>

            </div>

        </div>

        <div class="sub-right">

            <img src="statics/info-right.png" class="info-icon", id="info-right-icon">

            <div class="info-container">

              <div class="info-bubble">
                <img src="statics/folder.png" class="info-small-icon">
                <p class="info-text-right">
                    {{ vcfs.repository[1].informations().path|default(vcfs.repository[1]) }}
                </p>
              </div>

              <div class="info-bubble">
                <img src="statics/database.png" class="info-small-icon">
                <p class="info-text-right">
                    {{ vcfs.repository[1].informations().size|default('NA') }} Mo
                </p>
              </div>

              <div class="info-bubble">
                <img src="statics/file.png" class="info-small-icon">
                <p class="info-text-right">
                    {{ vcfs.repository[1].informations().mtime|default('NA') }}
                </p>
              </div>

            </div>

            <div style="position: relative; margin-right: 10px; margin-top: 10px;">

              <img src="statics/down-arrow-right.png" class="info-icon" id="dropdown-icon">

              <div class="notification-dot">
                <div class="notification-dot-ping"></div>
              </div>

            </div>
        </div>
    </div>

    <div class="expand-container">

      {% if table is not none %}
        <div class="popups">
          <div class="popups-container">
            <div class="popup">
              <div class="popup-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24" height="24" fill="none">
                  <path fill="#393a37" d="m12 1.5c-5.79844 0-10.5 4.70156-10.5 10.5 0 5.7984 4.70156 10.5 10.5 10.5 5.7984 0 10.5-4.7016 10.5-10.5 0-5.79844-4.7016-10.5-10.5-10.5zm.75 15.5625c0 .1031-.0844.1875-.1875.1875h-1.125c-.1031 0-.1875-.0844-.1875-.1875v-6.375c0-.1031.0844-.1875.1875-.1875h1.125c.1031 0 .1875.0844.1875.1875zm-.75-8.0625c-.2944-.00601-.5747-.12718-.7808-.3375-.206-.21032-.3215-.49305-.3215-.7875s.1155-.57718.3215-.7875c.2061-.21032.4864-.33149.7808-.3375.2944.00601.5747.12718.7808.3375.206.21032.3215.49305.3215.7875s-.1155.57718-.3215.7875c-.2061.21032-.4864.33149-.7808.3375z">
                  </path>
                </svg>
              </div>
              <div class="popup-title">This VCF has been set as <strong>reference</strong>.</div>
            </div>
          </div>
          <div class="popups-container">
            <div class="popup">
              <div class="popup-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24" height="24" fill="none">
                  <path fill="#393a37" d="m12 1.5c-5.79844 0-10.5 4.70156-10.5 10.5 0 5.7984 4.70156 10.5 10.5 10.5 5.7984 0 10.5-4.7016 10.5-10.5 0-5.79844-4.7016-10.5-10.5-10.5zm.75 15.5625c0 .1031-.0844.1875-.1875.1875h-1.125c-.1031 0-.1875-.0844-.1875-.1875v-6.375c0-.1031.0844-.1875.1875-.1875h1.125c.1031 0 .1875.0844.1875.1875zm-.75-8.0625c-.2944-.00601-.5747-.12718-.7808-.3375-.206-.21032-.3215-.49305-.3215-.7875s.1155-.57718.3215-.7875c.2061-.21032.4864-.33149.7808-.3375.2944.00601.5747.12718.7808.3375.206.21032.3215.49305.3215.7875s-.1155.57718-.3215.7875c-.2061.21032-.4864.33149-.7808.3375z">
                  </path>
                </svg>
              </div>
              <div class="popup-title">This VCF has been set as <strong>query</strong>.</div>
            </div>
          </div>
        </div>
      {% endif %}

      <div class="command">

        <p class="bash-text">
          <span class="user">user</span><span class="vm">@vcfdelta</span>:<span class="char">~</span>$
        </p>

        <input class="input" placeholder="{{ cmd }}" type="text" disabled>

      </div>

    </div>

    <section class="plots-section">

        <div class="plots-left-grid">
            {% for plot in vcfs.repository[0].variants.plots.as_html() %}
              <div class="plot {% if loop.index == 1 %}active{% endif %}" id="left-plot{{ loop.index }}">
                {{ plot }}
              </div>
            {% endfor %}
            <div class="plot-navigation">
              <div class="plot-nav-left">
                  <div class="nav-arrow left" id="leftPrevArrow">&#8592;</div>
                  <div class="plot-indicator" id="leftPlotIndicator"></div>
                  <div class="nav-arrow right" id="leftNextArrow">&#8594;</div>
              </div>
            </div>
        </div>

        <div class="plots-right-grid">
            {% for plot in vcfs.repository[1].variants.plots.as_html() %}
              <div class="plot {% if loop.index == 1 %}active{% endif %}" id="right-plot{{ loop.index }}">
                {{ plot }}
              </div>
            {% endfor %}
            <div class="plot-navigation">
              <div class="plot-nav-right">
                <div class="nav-arrow left" id="rightPrevArrow">&#8592;</div>
                <div class="plot-indicator" id="rightPlotIndicator"></div>
                <div class="nav-arrow right" id="rightNextArrow">&#8594;</div>
              </div>
            </div>
        </div>

    </section>

    <div class="sub">

        <div class="sub-left">
            <div class="Container">
                <img src="statics/search.png" alt="search-icon" class="filter-icon">
            </div>
        </div>

        <div class="sub-right">
            <div class="Container">
                <img src="statics/filters.png" alt="parameters-icon" class="filter-icon">
            </div>
        </div>

    </div>

    <div class="main">

        <div class="main-left">

            <div class="search-container">

                <img src="statics/chromosome.png" alt="chromosomes-icon" class="filter-icon">

                <div class="search">

                  <div class="search-box">

                    <div class="search-field">

                      <input placeholder="Search chromosome" class="input" type="text">

                      <div class="search-box-icon">

                        <button class="btn-icon-content">
                          <i class="search-icon">
                            <svg xmlns="://www.w3.org/2000/svg" version="1.1" viewBox="0 0 512 512">
                              <path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z" fill="#fff">
                              </path>
                            </svg>
                          </i>
                        </button>

                      </div>

                    </div>

                  </div>

                </div>

            </div>

            <div class="filters-container">
              <img src="statics/puzzle.png" alt="puzzle-icon" class="filter-icon">
              <div class="filter-container-left">
                <select class="filter left">
                    <option selected disabled>Select a filter...</option>
                    <option>ALL</option>
                    <option>MATCH</option>
                    <option>MISMATCH</option>
                </select>
              </div>
            </div>

        </div>

        <div class="main-right">
            <div class="filters-container">
                <img src="statics/filter.png" alt="filter-icon" class="filter-icon">
                <div class="filter-container-right">
                    <select class="filter right">
                        <option selected disabled>Select a filter...</option>
                        <option>ALL</option>
                        <option>PASS</option>
                        <option>FAIL</option>
                    </select>
                </div>
                <img src="statics/dna.png" alt="dna-icon" class="filter-icon">
                <div class="filter-container-right">
                    <select class="filter right">
                        <option selected disabled>Select a variant...</option>
                        <option>ALL</option>
                        <option>SNP</option>
                        <option>INDEL</option>
                        <option>OTHER</option>
                    </select>
                </div>
                <img src="statics/terminal.png" class="filter-icon" id="terminal-icon">
                <button class="reset-button" onclick="resetFilters()">Reset</button>
            </div>
        </div>
    </div>

    <div class="expand-container">
      <div class="terminal">
        <div class="terminal-header">
          <span class="terminal-title">
            <svg
              class="terminal-icon"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M4 17l6-6-6-6M12 19h8"></path>
            </svg>
            Terminal
          </span>
        </div>
        <div class="terminal-body">
          <div class="command-line">
            <div class="input-wrapper">
              <input
                type="text"
                class="input-field"
                placeholder="Enter query..."
              />
              <span class="cursor"></span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="popups">
      <div class="popups-container">
        <div class="error">
          <div class="error__icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24" height="24" fill="none"><path fill="#393a37" d="m13 13h-2v-6h2zm0 4h-2v-2h2zm-1-15c-1.3132 0-2.61358.25866-3.82683.7612-1.21326.50255-2.31565 1.23915-3.24424 2.16773-1.87536 1.87537-2.92893 4.41891-2.92893 7.07107 0 2.6522 1.05357 5.1957 2.92893 7.0711.92859.9286 2.03098 1.6651 3.24424 2.1677 1.21325.5025 2.51363.7612 3.82683.7612 2.6522 0 5.1957-1.0536 7.0711-2.9289 1.8753-1.8754 2.9289-4.4189 2.9289-7.0711 0-1.3132-.2587-2.61358-.7612-3.82683-.5026-1.21326-1.2391-2.31565-2.1677-3.24424-.9286-.92858-2.031-1.66518-3.2443-2.16773-1.2132-.50254-2.5136-.7612-3.8268-.7612z"></path></svg>
          </div>
          <div class="error__message">No variants were found with these filters.</div>
        </div>
      </div>
      
      <div class="popups-container">
        <div class="error">
          <div class="error__icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24" height="24" fill="none"><path fill="#393a37" d="m13 13h-2v-6h2zm0 4h-2v-2h2zm-1-15c-1.3132 0-2.61358.25866-3.82683.7612-1.21326.50255-2.31565 1.23915-3.24424 2.16773-1.87536 1.87537-2.92893 4.41891-2.92893 7.07107 0 2.6522 1.05357 5.1957 2.92893 7.0711.92859.9286 2.03098 1.6651 3.24424 2.1677 1.21325.5025 2.51363.7612 3.82683.7612 2.6522 0 5.1957-1.0536 7.0711-2.9289 1.8753-1.8754 2.9289-4.4189 2.9289-7.0711 0-1.3132-.2587-2.61358-.7612-3.82683-.5026-1.21326-1.2391-2.31565-2.1677-3.24424-.9286-.92858-2.031-1.66518-3.2443-2.16773-1.2132-.50254-2.5136-.7612-3.8268-.7612z"></path></svg>
          </div>
          <div class="error__message">No variants were found with these filters.</div>
        </div>
      </div>
    </div>

    <div class="Container">
        <div class="file-container" id="fileTab">
    
            <div class="comparison-container">
              <div class="file1-view">
                <div class="file1-title">2124FH000284F_S45_DV.vcf
                  <div class="metadatas">
                    <p class="filterSummary" id="filterSummaryL">Showing all variants</p>
                    {% if tags[0] %}
                      <div class="tags">
                        {% for tag in tags[0] %}
                          <span class="tag">{{ tag | trim }}</span>
                        {% endfor %}
                      </div>
                    {% endif %}  
                  </div>
                </div>
                <div class="file1-content" id="content1">
                  <div class="line header">
                    <div class="line-number">0</div>
                      <span class="header column">
                        {{ view['headers'][vcfs.repository[0]] }}
                      </span>
                  </div>
                  {% for index, series in view['variants'].iterrows() %}
                    {% if series['Variant.L']|is_nan or series['Variant.R']|is_nan %}
                      <div class="line diff" id="{{ series['Chromosome']|upper() }} {{ series['Type']|upper() }} {{ series['Filter.L']|upper() }}">
                        <div class="line-number">{{ loop.index }}</div>
                        {% if not series['Variant.L']|is_nan %}
                          <span class="diff column">
                            {{ series['Variant.L'] }}
                          </span>
                        {% endif %}
                      </div>
                    {% else %}
                      <div class="line match" id="{{ series['Chromosome']|upper() }} {{ series['Type']|upper() }} {{ series['Filter.L']|upper() }}">
                        <div class="line-number">{{ loop.index }}</div>
                        <span class="match column">
                          {{ series['Variant.L'] }}
                        </span>
                      </div>
                    {% endif %}    
                  {% endfor %}
                </div>
              </div>
              <div class="file2-view">
                <div class="file2-title">{{ vcfs.repository[1].informations().basename|default(vcfs.repository[1]) }} 
                  <div class="metadatas">
                    <p class="filterSummary" id="filterSummaryR">Showing all variants</p>
                    {% if tags[1] %}
                      <div class="tags">
                        {% for tag in tags[1] %}
                          <span class="tag">{{ tag | trim }}</span>
                        {% endfor %}
                      </div>
                    {% endif %}  
                  </div> 
                </div>
                <div class="file2-content" id="content2">
                  <div class="line header">
                    <div class="line-number">0</div>
                      <span class="header column">
                        {{ view['headers'][vcfs.repository[1]] }}
                      </span>
                  </div>
                  {% for index, series in view['variants'].iterrows() %}
                    {% if series['Variant.L']|is_nan or series['Variant.R']|is_nan %}
                      <div class="line diff" id="{{ series['Chromosome']|upper() }} {{ series['Type']|upper() }} {{ series['Filter.R']|upper() }}">
                        <div class="line-number">{{ loop.index }}</div>
                        {% if not series['Variant.R']|is_nan %}
                          <span class="diff column">
                            {{ series['Variant.R'] }}
                          </span>
                        {% endif %}
                      </div>
                    {% else %}
                      <div class="line match" id="{{ series['Chromosome']|upper() }} {{ series['Type']|upper() }} {{ series['Filter.R']|upper() }}">
                        <div class="line-number">{{ loop.index }}</div>
                        <span class="match column">
                          {{ series['Variant.R'] }}
                        </span>
                      </div>
                    {% endif %}
                  {% endfor %}
                </div>
              </div>
            </div>
            
            <div class="summary-container" id="stats">

              <section class="stats-section">

                <div class="stats-general">
                  <div class="stats-container">
                    
                    <div class="stat-card">
                      <div class="stats-container-match">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor" class="icon">
                          <rect x="96" y="176" width="320" height="48" rx="8" ry="8"/>
                          <rect x="96" y="288" width="320" height="48" rx="8" ry="8"/>
                        </svg>
                      </div>
                      <div class="content">
                        <p class="stat-value">1854</p>
                        <p class="stat-label">Matching lines</p>
                      </div>
                      <div class="stats-info-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24" height="24" fill="none">
                          <path fill="#393a37" d="m12 1.5c-5.79844 0-10.5 4.70156-10.5 10.5 0 5.7984 4.70156 10.5 10.5 10.5 5.7984 0 10.5-4.7016 10.5-10.5 0-5.79844-4.7016-10.5-10.5-10.5zm.75 15.5625c0 .1031-.0844.1875-.1875.1875h-1.125c-.1031 0-.1875-.0844-.1875-.1875v-6.375c0-.1031.0844-.1875.1875-.1875h1.125c.1031 0 .1875.0844.1875.1875zm-.75-8.0625c-.2944-.00601-.5747-.12718-.7808-.3375-.206-.21032-.3215-.49305-.3215-.7875s.1155-.57718.3215-.7875c.2061-.21032.4864-.33149.7808-.3375.2944.00601.5747.12718.7808.3375.206.21032.3215.49305.3215.7875s-.1155.57718-.3215.7875c-.2061.21032-.4864.33149-.7808.3375z">
                          </path>
                        </svg>
                        <div class="stats-info-message">
                          <p class="message"><strong>Matching</strong> criteria is based on: <strong>chromosome - position - reference allele - alternative allele</strong></p>
                        </div>
                      </div>
                    </div>
                    
                    <div class="stat-card">
                      <div class="stats-container-diff">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor" class="icon">
                          <rect x="96" y="176" width="320" height="48" rx="8" ry="8"/>
                          <rect x="96" y="288" width="320" height="48" rx="8" ry="8"/>
                          <line x1="120" y1="400" x2="392" y2="112" stroke="currentColor" stroke-width="48" stroke-linecap="round"/>
                        </svg>
                      </div>
                      <div class="content">
                        <p class="stat-value">7</p>
                        <p class="stat-label">Different lines</p>
                      </div>
                      <div class="stats-info-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24" height="24" fill="none">
                          <path fill="#393a37" d="m12 1.5c-5.79844 0-10.5 4.70156-10.5 10.5 0 5.7984 4.70156 10.5 10.5 10.5 5.7984 0 10.5-4.7016 10.5-10.5 0-5.79844-4.7016-10.5-10.5-10.5zm.75 15.5625c0 .1031-.0844.1875-.1875.1875h-1.125c-.1031 0-.1875-.0844-.1875-.1875v-6.375c0-.1031.0844-.1875.1875-.1875h1.125c.1031 0 .1875.0844.1875.1875zm-.75-8.0625c-.2944-.00601-.5747-.12718-.7808-.3375-.206-.21032-.3215-.49305-.3215-.7875s.1155-.57718.3215-.7875c.2061-.21032.4864-.33149.7808-.3375.2944.00601.5747.12718.7808.3375.206.21032.3215.49305.3215.7875s-.1155.57718-.3215.7875c-.2061.21032-.4864.33149-.7808.3375z">
                          </path>
                        </svg>
                        <div class="stats-info-message">
                          <p class="message"><strong>Matching</strong> criteria is based on: <strong>chromosome - position - reference allele - alternative allele</strong></p>
                        </div>
                      </div>
                    </div>
                    
                    <div class="stat-card">
                      <div class="stats-container-index">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor" class="icon">
                          <circle cx="200" cy="256" r="120" fill="none" stroke="currentColor" stroke-width="24" opacity="0.8"/>
                          <circle cx="312" cy="256" r="120" fill="none" stroke="currentColor" stroke-width="24" opacity="0.8"/>
                          <path d="M256,184 a72,72 0 0,1 0,144 a72,72 0 0,1 0,-144" fill="currentColor" opacity="0.6"/>
                          <text x="256" y="256" font-size="40" text-anchor="middle" dominant-baseline="middle" fill="currentColor">J</text>
                        </svg>
                      </div>
                      <div class="content">
                        <p class="stat-value">0.996</p>
                        <p class="stat-label">Jaccard index</p>
                      </div>
                      <div class="stats-info-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24" height="24" fill="none">
                          <path fill="#393a37" d="m12 1.5c-5.79844 0-10.5 4.70156-10.5 10.5 0 5.7984 4.70156 10.5 10.5 10.5 5.7984 0 10.5-4.7016 10.5-10.5 0-5.79844-4.7016-10.5-10.5-10.5zm.75 15.5625c0 .1031-.0844.1875-.1875.1875h-1.125c-.1031 0-.1875-.0844-.1875-.1875v-6.375c0-.1031.0844-.1875.1875-.1875h1.125c.1031 0 .1875.0844.1875.1875zm-.75-8.0625c-.2944-.00601-.5747-.12718-.7808-.3375-.206-.21032-.3215-.49305-.3215-.7875s.1155-.57718.3215-.7875c.2061-.21032.4864-.33149.7808-.3375.2944.00601.5747.12718.7808.3375.206.21032.3215.49305.3215.7875s-.1155.57718-.3215.7875c-.2061.21032-.4864.33149-.7808.3375z">
                          </path>
                        </svg>
                        <div class="stats-info-message">
                          <p class="message">Jaccard Index calculated as: <strong>common variant / total unique variants</strong></p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div> 
                <div class="stats-files">
                  <div class="stats-file">
                    <div class="stat-card">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 250" width="150" height="200">
                        <g transform="translate(100, 100)">
                        <!-- SNP (Single Nucleotide Polymorphism) Icon -->
                          <circle cx="0" cy="0" r="70" fill="#f8f9fa" stroke="#6c757d" stroke-width="3"/>
                          <text x="0" y="-20" font-family="Ubuntu" font-size="18" text-anchor="middle" fill="#212529">SNP</text>
                          <!-- DNA base representation -->
                          <rect x="-40" y="5" width="20" height="20" fill="#4285F4" rx="3" ry="3"/>
                          <rect x="-10" y="5" width="20" height="20" fill="#EA4335" rx="3" ry="3"/>
                          <rect x="20" y="5" width="20" height="20" fill="#34A853" rx="3" ry="3"/>
                          <text x="-30" y="20" font-family="Ubuntu" font-size="16" text-anchor="middle" fill="white">A</text>
                          <text x="0" y="20" font-family="Ubuntu" font-size="16" text-anchor="middle" fill="white">C</text>
                          <text x="30" y="20" font-family="Ubuntu" font-size="16" text-anchor="middle" fill="white">T</text>
                          <path d="M0,35 L0,45 M-10,45 L10,45" stroke="#212529" stroke-width="3"/>
                          <path d="M-3,50 L3,50" stroke="#EA4335" stroke-width="5" stroke-linecap="round"/>
                        </g>
                      </svg>
                      <div class="content">
                        <p class="stat-value">NA | NA</p>
                        <div class="stats-bar" id="stats-bar-snp">
                          <div class="progress-left">
                          </div>
                          <div class="progress-right">
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="stat-card">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 250" width="150" height="200">
                        <g transform="translate(100, 100)">
                          <circle cx="0" cy="0" r="70" fill="#f8f9fa" stroke="#6c757d" stroke-width="3"/>
                          <text x="0" y="-20" font-family="Ubuntu" font-size="18" text-anchor="middle" fill="#212529">MNP</text>
                          <!-- Multiple DNA bases -->
                          <rect x="-50" y="5" width="20" height="20" fill="#4285F4" rx="3" ry="3"/>
                          <rect x="-25" y="5" width="20" height="20" fill="#EA4335" rx="3" ry="3"/>
                          <rect x="0" y="5" width="20" height="20" fill="#FBBC05" rx="3" ry="3"/>
                          <rect x="25" y="5" width="20" height="20" fill="#34A853" rx="3" ry="3"/>
                          <text x="-40" y="20" font-family="Ubuntu" font-size="16" text-anchor="middle" fill="white">A</text>
                          <text x="-15" y="20" font-family="Ubuntu" font-size="16" text-anchor="middle" fill="white">C</text>
                          <text x="10" y="20" font-family="Ubuntu" font-size="16" text-anchor="middle" fill="white">G</text>
                          <text x="35" y="20" font-family="Ubuntu" font-size="16" text-anchor="middle" fill="white">T</text>
                          <path d="M0,35 L0,45 M-25,45 L25,45" stroke="#212529" stroke-width="3"/>
                          <path d="M-18,50 L18,50" stroke="#EA4335" stroke-width="5" stroke-linecap="round"/>
                        </g>
                      </svg>
                      <div class="content">
                        <p class="stat-value">NA | NA</p>
                        <div class="stats-bar" id="stats-bar-mnp">
                          <div class="progress-left">
                          </div>
                          <div class="progress-right">
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="stat-card">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 250" width="150" height="200">
                        <g transform="translate(100, 100)">
                          <circle cx="0" cy="0" r="70" fill="#f8f9fa" stroke="#6c757d" stroke-width="3"/>
                          <text x="0" y="-20" font-family="Ubuntu" font-size="18" text-anchor="middle" fill="#212529">SV</text>
                          <!-- DNA strand restructuring representation -->
                          <path d="M-45,5 L-15,5 L-15,15 L-45,15 Z" fill="#4285F4"/>
                          <path d="M-10,5 L20,5 L20,15 L-10,15 Z" fill="#34A853"/>
                          <path d="M25,5 L45,5 L45,15 L25,15 Z" fill="#EA4335"/>
                          <path d="M-45,20 L-25,20 L-25,30 L-45,30 Z" fill="#4285F4"/>
                          <path d="M25,20 L45,20 L45,30 L25,30 Z" fill="#34A853"/>
                          <path d="M-20,20 L20,20 L20,30 L-20,30 Z" fill="#EA4335"/>
                          <!-- Arrows indicating structural change -->
                          <path d="M0,35 C-15,45 15,45 0,55" fill="none" stroke="#212529" stroke-width="2" marker-end="url(#arrowhead)"/>
                          <path d="M-25,35 C-40,45 -10,45 -25,55" fill="none" stroke="#212529" stroke-width="2" marker-end="url(#arrowhead)"/>
                          <path d="M25,35 C10,45 40,45 25,55" fill="none" stroke="#212529" stroke-width="2" marker-end="url(#arrowhead)"/>
                          <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#212529"/>
                          </marker>
                        </g>
                      </svg>
                      <div class="content">
                        <p class="stat-value">NA | NA</p>
                        <div class="stats-bar" id="stats-bar-sv">
                          <div class="progress-left">
                          </div>
                          <div class="progress-right">
                          </div>
                        </div>
                      </div>
                    </div>


                    <div class="stat-card">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 250" width="150" height="200">
                        <g transform="translate(100, 100)">
                          <circle cx="0" cy="0" r="70" fill="#f8f9fa" stroke="#6c757d" stroke-width="3"/>
                          <text x="0" y="-20" font-family="Ubuntu" font-size="18" text-anchor="middle" fill="#212529">INDEL</text>
                          <!-- DNA strand with insertion/deletion -->
                          <rect x="-45" y="0" width="15" height="15" fill="#4285F4" rx="2" ry="2"/>
                          <rect x="-25" y="0" width="15" height="15" fill="#EA4335" rx="2" ry="2"/>
                          <rect x="-5" y="0" width="15" height="15" fill="#FBBC05" rx="2" ry="2"/>
                          <rect x="15" y="0" width="15" height="15" fill="#34A853" rx="2" ry="2"/>
                          <rect x="35" y="0" width="15" height="15" fill="#4285F4" rx="2" ry="2"/>
                          
                          <!-- Reference strand -->
                          <rect x="-45" y="25" width="15" height="15" fill="#4285F4" rx="2" ry="2"/>
                          <rect x="-25" y="25" width="15" height="15" fill="#EA4335" rx="2" ry="2"/>
                          <!-- Gap representing deletion -->
                          <rect x="15" y="25" width="15" height="15" fill="#34A853" rx="2" ry="2"/>
                          <rect x="35" y="25" width="15" height="15" fill="#4285F4" rx="2" ry="2"/>
                          
                          <!-- Arrows indicating insertion/deletion -->
                          <path d="M-5,17 L15,17" stroke="#212529" stroke-width="1.5"/>
                          <path d="M5,15 L5,19" stroke="#212529" stroke-width="1.5"/>
                          <path d="M-5,42 L15,42" stroke="#212529" stroke-width="1.5"/>
                          <line x1="5" y1="25" x2="5" y2="42" stroke="#212529" stroke-width="1.5" stroke-dasharray="3,3"/>
                        </g>
                      </svg>
                      <div class="content">
                        <p class="stat-value">NA | NA</p>
                        <div class="stats-bar" id="stats-bar-indel">
                          <div class="progress-left">
                          </div>
                          <div class="progress-right">
                          </div>
                        </div>
                      </div>
                    </div>


                    <div class="stat-card">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 250" width="150" height="200">
                        <g transform="translate(100, 100)">
                          <circle cx="0" cy="0" r="70" fill="#f8f9fa" stroke="#6c757d" stroke-width="3"/>
                          <text x="0" y="-20" font-family="Ubuntu" font-size="18" text-anchor="middle" fill="#212529">INV</text>
                          
                          <!-- Original DNA sequence -->
                          <rect x="-45" y="0" width="15" height="15" fill="#4285F4" rx="2" ry="2"/>
                          <rect x="-25" y="0" width="15" height="15" fill="#EA4335" rx="2" ry="2"/>
                          <rect x="-5" y="0" width="15" height="15" fill="#FBBC05" rx="2" ry="2"/>
                          <rect x="15" y="0" width="15" height="15" fill="#34A853" rx="2" ry="2"/>
                          <rect x="35" y="0" width="15" height="15" fill="#4285F4" rx="2" ry="2"/>
                          
                          <text x="-37.5" y="12" font-family="Ubuntu" font-size="12" text-anchor="middle" fill="white">A</text>
                          <text x="-17.5" y="12" font-family="Ubuntu" font-size="12" text-anchor="middle" fill="white">C</text>
                          <text x="2.5" y="12" font-family="Ubuntu" font-size="12" text-anchor="middle" fill="white">G</text>
                          <text x="22.5" y="12" font-family="Ubuntu" font-size="12" text-anchor="middle" fill="white">T</text>
                          <text x="42.5" y="12" font-family="Ubuntu" font-size="12" text-anchor="middle" fill="white">A</text>
                          
                          <!-- Inverted DNA sequence -->
                          <rect x="-45" y="35" width="15" height="15" fill="#4285F4" rx="2" ry="2"/>
                          <rect x="-25" y="35" width="15" height="15" fill="#34A853" rx="2" ry="2"/>
                          <rect x="-5" y="35" width="15" height="15" fill="#FBBC05" rx="2" ry="2"/>
                          <rect x="15" y="35" width="15" height="15" fill="#EA4335" rx="2" ry="2"/>
                          <rect x="35" y="35" width="15" height="15" fill="#4285F4" rx="2" ry="2"/>
                          
                          <text x="-37.5" y="47" font-family="Ubuntu" font-size="12" text-anchor="middle" fill="white">A</text>
                          <text x="-17.5" y="47" font-family="Ubuntu" font-size="12" text-anchor="middle" fill="white">T</text>
                          <text x="2.5" y="47" font-family="Ubuntu" font-size="12" text-anchor="middle" fill="white">G</text>
                          <text x="22.5" y="47" font-family="Ubuntu" font-size="12" text-anchor="middle" fill="white">C</text>
                          <text x="42.5" y="47" font-family="Ubuntu" font-size="12" text-anchor="middle" fill="white">A</text>
                          
                          <!-- Arrows showing inversion -->
                          <path d="M-15,20 C-15,25 15,30 15,20" fill="none" stroke="#212529" stroke-width="2" marker-end="url(#arrowhead2)"/>
                          <path d="M15,20 C15,25 -15,30 -15,20" fill="none" stroke="#212529" stroke-width="2" marker-end="url(#arrowhead2)"/>
                          <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#212529"/>
                          </marker>
                        </g>
                      </svg>
                      <div class="content">
                        <p class="stat-value">NA | NA</p>
                        <div class="stats-bar" id="stats-bar-inv">
                          <div class="progress-left">
                          </div>
                          <div class="progress-right">
                          </div>
                        </div>
                      </div>
                    </div>
                    

                    <div class="stat-card">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 250" width="150" height="200">
                        <g transform="translate(100, 100)">
                          <circle cx="0" cy="0" r="70" fill="#f8f9fa" stroke="#6c757d" stroke-width="3"/>
                          <text x="0" y="-20" font-family="Arial" font-size="18" text-anchor="middle" fill="#212529">Complex</text>
                          
                          <!-- DNA sequences with multiple variant types -->
                          <rect x="-45" y="-5" width="15" height="15" fill="#4285F4" rx="2" ry="2"/>
                          <rect x="-25" y="-5" width="15" height="15" fill="#EA4335" rx="2" ry="2"/>
                          <rect x="-5" y="-5" width="15" height="15" fill="#FBBC05" rx="2" ry="2"/>
                          <rect x="15" y="-5" width="15" height="15" fill="#34A853" rx="2" ry="2"/>
                          <rect x="35" y="-5" width="15" height="15" fill="#4285F4" rx="2" ry="2"/>
                          
                          <!-- Modified sequence with multiple variant types -->
                          <rect x="-45" y="25" width="15" height="15" fill="#4285F4" rx="2" ry="2"/>
                          <!-- Missing base (deletion) -->
                          <rect x="-5" y="25" width="25" height="15" fill="#EA4335" rx="2" ry="2"/>
                          <!-- Different base (SNP) -->
                          <rect x="25" y="25" width="15" height="15" fill="#34A853" rx="2" ry="2"/>
                          <rect x="45" y="25" width="15" height="15" fill="#4285F4" rx="2" ry="2"/>
                          
                          <!-- Mixed effect indicators -->
                          <path d="M-37.5,-5 L-37.5,25" stroke="#212529" stroke-width="1" stroke-dasharray="2,2"/>
                          <path d="M-17.5,-5 L-17.5,10" stroke="#212529" stroke-width="1" stroke-dasharray="2,2"/>
                          <path d="M2.5,-5 L7.5,25" stroke="#212529" stroke-width="1" stroke-dasharray="2,2"/>
                          <path d="M22.5,-5 L32.5,25" stroke="#212529" stroke-width="1" stroke-dasharray="2,2"/>
                          <path d="M42.5,-5 L52.5,25" stroke="#212529" stroke-width="1" stroke-dasharray="2,2"/>
                          
                          <!-- Variant type symbols -->
                          <circle cx="-17.5" y="15" r="3" fill="#EA4335"/>
                          <rect x="2.5" y="12" width="6" height="6" fill="#FBBC05"/>
                          <path d="M30,15 l4,-4 l4,4 l-4,4 z" fill="#34A853"/>
                          
                          <!-- "Multiple effects" indicator -->
                          <path d="M0,50 L-20,60 L20,60 Z" fill="#6c757d"/>
                        </g>
                      </svg>
                      <div class="content">
                        <p class="stat-value">NA | NA</p>
                        <div class="stats-bar" id="stats-bar-comp">
                          <div class="progress-left">
                          </div>
                          <div class="progress-right">
                          </div>
                        </div>
                      </div>
                    </div>

                  </div>
                </div> 

              </section>

              <div class="plot active common">
                {{ view["plots"].as_html()[0] }}
              </div>

            </div>

        </div>

        {% if table is not none %}
          <button class="benchmark-button">
            <div class="benchmark-button-background"></div>
            <span class="benchmark-button-content">
              <svg
                viewBox="0 0 24 24"
                stroke="currentColor"
                fill="none"
                class="benchmark-button-icon"
              >
                <path
                  d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                  stroke-width="2"
                  stroke-linejoin="round"
                  stroke-linecap="round"
                ></path>
              </svg>
              Hover for Info
            </span>
            <p class="benchmark-info-message">Benchmarking is carried out on exact equality in terms of chromosome, position, reference and alternative allele.</p>
          </button>
          <div style="display: flex; width: 100%; justify-content: center; align-items: center; background: white;">
            <table class="benchmark-table">
              <tbody>
                <tr class="row-table">
                  <th class="header-table">TYPE</th>
                  <th class="header-table">FILTER</th>
                  <th class="header-table">
                    <div style="display: flex; align-items: center;">
                      TRUTH TOTAL
                      <a href="#">
                        <svg style="width:0.75rem; height:0.75rem" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="black" viewBox="0 0 24 24">
                          <path d="M8.574 11.024h6.852a2.075 2.075 0 0 0 1.847-1.086 1.9 1.9 0 0 0-.11-1.986L13.736 2.9a2.122 2.122 0 0 0-3.472 0L6.837 7.952a1.9 1.9 0 0 0-.11 1.986 2.074 2.074 0 0 0 1.847 1.086Zm6.852 1.952H8.574a2.072 2.072 0 0 0-1.847 1.087 1.9 1.9 0 0 0 .11 1.985l3.426 5.05a2.123 2.123 0 0 0 3.472 0l3.427-5.05a1.9 1.9 0 0 0 .11-1.985 2.074 2.074 0 0 0-1.846-1.087Z"/>
                        </svg>
                      </a>
                    </div>
                  </th>
                  <th class="header-table">
                    <div style="display: flex; align-items: center;">
                      TRUE POSITIVE
                      <a href="#">
                        <svg style="width:0.75rem; height:0.75rem" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="black" viewBox="0 0 24 24">
                          <path d="M8.574 11.024h6.852a2.075 2.075 0 0 0 1.847-1.086 1.9 1.9 0 0 0-.11-1.986L13.736 2.9a2.122 2.122 0 0 0-3.472 0L6.837 7.952a1.9 1.9 0 0 0-.11 1.986 2.074 2.074 0 0 0 1.847 1.086Zm6.852 1.952H8.574a2.072 2.072 0 0 0-1.847 1.087 1.9 1.9 0 0 0 .11 1.985l3.426 5.05a2.123 2.123 0 0 0 3.472 0l3.427-5.05a1.9 1.9 0 0 0 .11-1.985 2.074 2.074 0 0 0-1.846-1.087Z"/>
                        </svg>
                      </a>
                    </div>
                  </th>
                  <th class="header-table">
                    <div style="display: flex; align-items: center;">
                      FALSE NEGATIVE
                      <a href="#">
                        <svg style="width:0.75rem; height:0.75rem" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="black" viewBox="0 0 24 24">
                          <path d="M8.574 11.024h6.852a2.075 2.075 0 0 0 1.847-1.086 1.9 1.9 0 0 0-.11-1.986L13.736 2.9a2.122 2.122 0 0 0-3.472 0L6.837 7.952a1.9 1.9 0 0 0-.11 1.986 2.074 2.074 0 0 0 1.847 1.086Zm6.852 1.952H8.574a2.072 2.072 0 0 0-1.847 1.087 1.9 1.9 0 0 0 .11 1.985l3.426 5.05a2.123 2.123 0 0 0 3.472 0l3.427-5.05a1.9 1.9 0 0 0 .11-1.985 2.074 2.074 0 0 0-1.846-1.087Z"/>
                        </svg>
                      </a>
                    </div>
                  </th>
                  <th class="header-table">
                    <div style="display: flex; align-items: center;">
                      QUERY TOTAL
                      <a href="#">
                        <svg style="width:0.75rem; height:0.75rem" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="black" viewBox="0 0 24 24">
                          <path d="M8.574 11.024h6.852a2.075 2.075 0 0 0 1.847-1.086 1.9 1.9 0 0 0-.11-1.986L13.736 2.9a2.122 2.122 0 0 0-3.472 0L6.837 7.952a1.9 1.9 0 0 0-.11 1.986 2.074 2.074 0 0 0 1.847 1.086Zm6.852 1.952H8.574a2.072 2.072 0 0 0-1.847 1.087 1.9 1.9 0 0 0 .11 1.985l3.426 5.05a2.123 2.123 0 0 0 3.472 0l3.427-5.05a1.9 1.9 0 0 0 .11-1.985 2.074 2.074 0 0 0-1.846-1.087Z"/>
                        </svg>
                      </a>
                    </div>
                  </th>
                  <th class="header-table">
                    <div style="display: flex; align-items: center;">
                      FALSE POSITIVE
                      <a href="#">
                        <svg style="width:0.75rem; height:0.75rem" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="black" viewBox="0 0 24 24">
                          <path d="M8.574 11.024h6.852a2.075 2.075 0 0 0 1.847-1.086 1.9 1.9 0 0 0-.11-1.986L13.736 2.9a2.122 2.122 0 0 0-3.472 0L6.837 7.952a1.9 1.9 0 0 0-.11 1.986 2.074 2.074 0 0 0 1.847 1.086Zm6.852 1.952H8.574a2.072 2.072 0 0 0-1.847 1.087 1.9 1.9 0 0 0 .11 1.985l3.426 5.05a2.123 2.123 0 0 0 3.472 0l3.427-5.05a1.9 1.9 0 0 0 .11-1.985 2.074 2.074 0 0 0-1.846-1.087Z"/>
                        </svg>
                      </a>
                    </div>
                  </th>
                  <th class="header-table">
                    <div style="display: flex; align-items: center;">
                      RECALL
                      <a href="#">
                        <svg style="width:0.75rem; height:0.75rem" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="black" viewBox="0 0 24 24">
                          <path d="M8.574 11.024h6.852a2.075 2.075 0 0 0 1.847-1.086 1.9 1.9 0 0 0-.11-1.986L13.736 2.9a2.122 2.122 0 0 0-3.472 0L6.837 7.952a1.9 1.9 0 0 0-.11 1.986 2.074 2.074 0 0 0 1.847 1.086Zm6.852 1.952H8.574a2.072 2.072 0 0 0-1.847 1.087 1.9 1.9 0 0 0 .11 1.985l3.426 5.05a2.123 2.123 0 0 0 3.472 0l3.427-5.05a1.9 1.9 0 0 0 .11-1.985 2.074 2.074 0 0 0-1.846-1.087Z"/>
                        </svg>
                      </a>
                    </div>
                  </th>
                  <th class="header-table">
                    <div style="display: flex; align-items: center;">
                      PRECISION
                      <a href="#">
                        <svg style="width:0.75rem; height:0.75rem" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="black" viewBox="0 0 24 24">
                          <path d="M8.574 11.024h6.852a2.075 2.075 0 0 0 1.847-1.086 1.9 1.9 0 0 0-.11-1.986L13.736 2.9a2.122 2.122 0 0 0-3.472 0L6.837 7.952a1.9 1.9 0 0 0-.11 1.986 2.074 2.074 0 0 0 1.847 1.086Zm6.852 1.952H8.574a2.072 2.072 0 0 0-1.847 1.087 1.9 1.9 0 0 0 .11 1.985l3.426 5.05a2.123 2.123 0 0 0 3.472 0l3.427-5.05a1.9 1.9 0 0 0 .11-1.985 2.074 2.074 0 0 0-1.846-1.087Z"/>
                        </svg>
                      </a>
                    </div>
                  </th>
                  <th class="header-table">
                    <div style="display: flex; align-items: center;">
                      F1 SCORE
                      <a href="#">
                        <svg style="width:0.75rem; height:0.75rem" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="black" viewBox="0 0 24 24">
                          <path d="M8.574 11.024h6.852a2.075 2.075 0 0 0 1.847-1.086 1.9 1.9 0 0 0-.11-1.986L13.736 2.9a2.122 2.122 0 0 0-3.472 0L6.837 7.952a1.9 1.9 0 0 0-.11 1.986 2.074 2.074 0 0 0 1.847 1.086Zm6.852 1.952H8.574a2.072 2.072 0 0 0-1.847 1.087 1.9 1.9 0 0 0 .11 1.985l3.426 5.05a2.123 2.123 0 0 0 3.472 0l3.427-5.05a1.9 1.9 0 0 0 .11-1.985 2.074 2.074 0 0 0-1.846-1.087Z"/>
                        </svg>
                      </a>
                    </div>
                  </th>
                </tr>
                {% for row, metrics in table.iterrows() %}
                  <tr class="row-table">
                    {% for index, metric in metrics.items() %}
                      {% if metric is float() %}
                        <td class="cell-table">{{ metric|round(2, 'common') }}</td>
                      {% elif metric is string() %}
                        <td class="cell-table">{{ metric|upper() }}</td>
                      {% else %}
                        <td class="cell-table">{{ metric }}</td>
                      {% endif %}  
                    {% endfor %}
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>  
        {% endif %}
    </div>

    <script>
        const content1El = document.getElementById('content1');
        const content2El = document.getElementById('content2');
        
        // Sync scrolling between panels
        content1El.addEventListener('scroll', () => {
        content2El.scrollTop = content1El.scrollTop;
        });
        
        content2El.addEventListener('scroll', () => {
        content1El.scrollTop = content2El.scrollTop;
        });

        content1El.addEventListener('scroll', () => {
        content2El.scrollLeft = content1El.scrollLeft;
        });
        
        content2El.addEventListener('scroll', () => {
        content1El.scrollLeft = content2El.scrollLeft;
        });
        
        function interpretTabs(className) {
        document.querySelectorAll("." + className).forEach(element => {
            element.innerHTML = element.innerHTML.split("\\t").join('&nbsp;&nbsp;&nbsp;&nbsp;');
        });
        }
        interpretTabs("header.column")
        interpretTabs("match.column");
        interpretTabs("diff.column");
    </script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
          // Left side plot navigation
          const leftPlots = document.querySelectorAll('.plots-left-grid .plot');
          const leftPrevArrow = document.getElementById('leftPrevArrow');
          const leftNextArrow = document.getElementById('leftNextArrow');
          const leftPlotIndicator = document.getElementById('leftPlotIndicator');
          let leftCurrentPlot = 0;
          
          // Right side plot navigation
          const rightPlots = document.querySelectorAll('.plots-right-grid .plot');
          const rightPrevArrow = document.getElementById('rightPrevArrow');
          const rightNextArrow = document.getElementById('rightNextArrow');
          const rightPlotIndicator = document.getElementById('rightPlotIndicator');
          let rightCurrentPlot = 0;
          
          // Hide arrows if only one plot
          if (leftPlots.length <= 1) {
              leftPrevArrow.style.display = 'none';
              leftNextArrow.style.display = 'none';
          }
          
          if (rightPlots.length <= 1) {
              rightPrevArrow.style.display = 'none';
              rightNextArrow.style.display = 'none';
          }
          
          // Create dot indicators for left plots
          for (let i = 0; i < leftPlots.length; i++) {
              const dot = document.createElement('div');
              dot.className = i === 0 ? 'plot-dot active' : 'plot-dot';
              leftPlotIndicator.appendChild(dot);
          }
          
          // Create dot indicators for right plots
          for (let i = 0; i < rightPlots.length; i++) {
              const dot = document.createElement('div');
              dot.className = i === 0 ? 'plot-dot active' : 'plot-dot';
              rightPlotIndicator.appendChild(dot);
          }
          
          // Ensure inactive plots are fully hidden
          leftPlots.forEach((plot, index) => {
              if (index !== leftCurrentPlot) {
                  plot.style.display = 'none';
                  plot.style.visibility = 'hidden';
                  plot.style.gridArea = 'none'; // Remove from grid layout
              } else {
                  plot.style.display = 'block';
                  plot.style.visibility = 'visible';
                  plot.style.gridArea = 'auto'; // Use default grid positioning
              }
          });
          
          rightPlots.forEach((plot, index) => {
              if (index !== rightCurrentPlot) {
                  plot.style.display = 'none';
                  plot.style.visibility = 'hidden';
                  plot.style.gridArea = 'none'; // Remove from grid layout
              } else {
                  plot.style.display = 'block';
                  plot.style.visibility = 'visible';
                  plot.style.gridArea = 'auto'; // Use default grid positioning
              }
          });
          
          // Left plot navigation
          leftPrevArrow.addEventListener('click', () => {
              leftPlots[leftCurrentPlot].classList.remove('active');
              leftPlots[leftCurrentPlot].style.display = 'none';
              leftPlots[leftCurrentPlot].style.visibility = 'hidden';
              leftPlots[leftCurrentPlot].style.gridArea = 'none';
              
              leftPlotIndicator.children[leftCurrentPlot].classList.remove('active');
              leftCurrentPlot = (leftCurrentPlot - 1 + leftPlots.length) % leftPlots.length;
              
              leftPlots[leftCurrentPlot].classList.add('active');
              leftPlots[leftCurrentPlot].style.display = 'block';
              leftPlots[leftCurrentPlot].style.visibility = 'visible';
              leftPlots[leftCurrentPlot].style.gridArea = 'auto';
              
              leftPlotIndicator.children[leftCurrentPlot].classList.add('active');
          });
          
          leftNextArrow.addEventListener('click', () => {
              leftPlots[leftCurrentPlot].classList.remove('active');
              leftPlots[leftCurrentPlot].style.display = 'none';
              leftPlots[leftCurrentPlot].style.visibility = 'hidden';
              leftPlots[leftCurrentPlot].style.gridArea = 'none';
              
              leftPlotIndicator.children[leftCurrentPlot].classList.remove('active');
              leftCurrentPlot = (leftCurrentPlot + 1) % leftPlots.length;
              
              leftPlots[leftCurrentPlot].classList.add('active');
              leftPlots[leftCurrentPlot].style.display = 'block';
              leftPlots[leftCurrentPlot].style.visibility = 'visible';
              leftPlots[leftCurrentPlot].style.gridArea = 'auto';
              
              leftPlotIndicator.children[leftCurrentPlot].classList.add('active');
          });
          
          // Right plot navigation
          rightPrevArrow.addEventListener('click', () => {
              rightPlots[rightCurrentPlot].classList.remove('active');
              rightPlots[rightCurrentPlot].style.display = 'none';
              rightPlots[rightCurrentPlot].style.visibility = 'hidden';
              rightPlots[rightCurrentPlot].style.gridArea = 'none';
              
              rightPlotIndicator.children[rightCurrentPlot].classList.remove('active');
              rightCurrentPlot = (rightCurrentPlot - 1 + rightPlots.length) % rightPlots.length;
              
              rightPlots[rightCurrentPlot].classList.add('active');
              rightPlots[rightCurrentPlot].style.display = 'block';
              rightPlots[rightCurrentPlot].style.visibility = 'visible';
              rightPlots[rightCurrentPlot].style.gridArea = 'auto';
              
              rightPlotIndicator.children[rightCurrentPlot].classList.add('active');
          });
          
          rightNextArrow.addEventListener('click', () => {
              rightPlots[rightCurrentPlot].classList.remove('active');
              rightPlots[rightCurrentPlot].style.display = 'none';
              rightPlots[rightCurrentPlot].style.visibility = 'hidden';
              rightPlots[rightCurrentPlot].style.gridArea = 'none';
              
              rightPlotIndicator.children[rightCurrentPlot].classList.remove('active');
              rightCurrentPlot = (rightCurrentPlot + 1) % rightPlots.length;
              
              rightPlots[rightCurrentPlot].classList.add('active');
              rightPlots[rightCurrentPlot].style.display = 'block';
              rightPlots[rightCurrentPlot].style.visibility = 'visible';
              rightPlots[rightCurrentPlot].style.gridArea = 'auto';
              
              rightPlotIndicator.children[rightCurrentPlot].classList.add('active');
          });
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
          document.querySelector(".search-box .input").addEventListener("input", filter);
          document.querySelectorAll(".filter-container-right select").forEach(select => select.addEventListener("change", filter));
          document.querySelector(".filter-container-left select").addEventListener("change",filter);
      });
      function filter() {

        let matchs = ["MATCH","MISMATCH"]
        let filters = ["PASS", "FAIL"]
        let variants = ["SNP", "INDEL", "OTHER"]

        let rowsLeft = document.querySelectorAll(".file1-content .line:not(.header)");
        let rowsRight = document.querySelectorAll(".file2-content .line:not(.header)");

        let totalLineLeft = document.querySelectorAll(".file1-content .line:not(.header) span").length;
        let totalLineRight = document.querySelectorAll(".file2-content .line:not(.header) span").length;
          
        let chromosomeUserInput = document.querySelector(".search-container .search-field input.input");
        if (!chromosomeUserInput) {
            chromosomeUserInput = document.querySelector(".search .search-field input.input");
        }
        
        let chromosomeQuery = chromosomeUserInput ? chromosomeUserInput.value.trim().toUpperCase() : "";
          
        let filtersLeft = document.querySelector(".filter-container-left .filter");
        let filtersRight = document.querySelectorAll(".filter-container-right .filter");

        let matchQuery = matchs.includes(filtersLeft.value.toUpperCase()) ? filtersLeft.value : "ALL";
        let variantFilterQuery = filtersRight.length > 0 && filters.includes(filtersRight[0].value) ? filtersRight[0].value.toUpperCase() : "ALL";
        let variantTypeQuery = filtersRight.length > 1 && variants.includes(filtersRight[1].value) ? filtersRight[1].value.toUpperCase() : "ALL";

        let statsByVariantType = document.querySelectorAll(".stats-file .stat-card .content");

        let countVisibleLeft = 0;
        let countVisibleRight = 0;
        let countMatchLine = 0;
        let countMismatchLine = 0;

        let countSNP = [0, 0]
        let countINDEL = [0, 0]
        let countSV = [0, 0]

        rowsLeft.forEach((rowLeft, index) => {

            let rowLeftInfs = rowLeft.id.split(" ");
            if (rowLeftInfs.length < 3) return;

            let rowRight = rowsRight[index];
            let rowRightInfs = rowRight.id.split(" ");
              
            let isLineClass = matchQuery === "ALL" || rowLeft.className.split(" ")[1] === (matchQuery === "MATCH" ? "match": "diff");
      
            let isChromosome = chromosomeQuery === "" || rowLeftInfs[0] == chromosomeQuery;
            let isVariantType = variantTypeQuery === "ALL" || rowLeftInfs[1] === variantTypeQuery;
            let isVariantFilterLeft = variantFilterQuery === "ALL" || rowLeftInfs[2] === variantFilterQuery;
            let isVariantFilterRight = variantFilterQuery === "ALL" || rowRightInfs[2] === variantFilterQuery;
    
            let isRowVisible = (isChromosome && isVariantType && isLineClass && (isVariantFilterLeft || isVariantFilterRight));

            countMatchLine = isRowVisible && rowLeft.className.split(" ")[1] == "match" ? ++countMatchLine : countMatchLine;
            countMismatchLine = isRowVisible && rowLeft.className.split(" ")[1] == "diff" ? ++countMismatchLine : countMismatchLine;

            if (isRowVisible){
              let variantType
              if (rowLeft.querySelector("span")){
                variantType = rowLeftInfs[1].toUpperCase()
                if (variantType == "SNP") {
                  ++countSNP[0];
                }
                else if (variantType == "INDEL"){
                  ++countINDEL[0];
                }
                else if (variantType == "SV"){
                  ++countSV[0];
                }
              }

              if (rowRight.querySelector("span")){
                variantType = rowRightInfs[1].toUpperCase()
                if (variantType == "SNP") {
                  ++countSNP[1];
                }
                else if (variantType == "INDEL"){
                  ++countINDEL[1];
                }
                else if (variantType == "SV"){
                  ++countSV[1];
                }
              }
            }

            console.log(`Row ${index}:`, {
                isChromosome, isVariantType, isLineClass, isVariantFilterLeft, isVariantFilterRight, isRowVisible
            });

            countVisibleLeft = isRowVisible && rowLeft.querySelector("span") ? ++countVisibleLeft : countVisibleLeft;
            countVisibleRight = isRowVisible && rowRight.querySelector("span") ? ++countVisibleRight : countVisibleRight;

            rowLeft.style.display = isRowVisible ? "flex" : "none";
            rowRight.style.display = isRowVisible ? "flex" : "none";

        });
          
        document.getElementById("filterSummaryL").innerText = `Showing ${countVisibleLeft} variants out of ${totalLineLeft}`;
        document.getElementById("filterSummaryR").innerText = `Showing ${countVisibleRight} variants out of ${totalLineRight}`;

        if (countVisibleLeft+countVisibleRight == 0) {
          document.querySelectorAll(".error").forEach(error => error.style.display = "flex")
        }
        else {
          document.querySelectorAll(".error").forEach(error => error.style.display = "none")
        }

        let statsGeneral = document.querySelectorAll(".stat-card .content .stat-value");
        statsGeneral[0].textContent = countMatchLine;
        statsGeneral[1].textContent = countMismatchLine;
        statsGeneral[2].textContent = (countMatchLine / (countVisibleLeft + countVisibleRight - countMatchLine)).toPrecision(3);

        statsByVariantType.forEach((composition) => {

          let value = composition.firstElementChild

          let bar = composition.lastElementChild

          let progresses = bar.children;
            
          if (bar.id == "stats-bar-snp"){

            value.textContent = `${countSNP[0]} | ${countSNP[1]}`

            let sumSNP = (countSNP.reduce((accumulator, currentValue) => accumulator + currentValue, 0))
            let pourcentageLeft = sumSNP ? ((countSNP[0] / sumSNP) * 100) : 0;
            let pourcentageRight = sumSNP ? ((countSNP[1] / sumSNP) * 100) : 0;
              
            if (pourcentageLeft == 100) {
              progresses[0].style.borderTopRightRadius = "9999px";
              progresses[0].style.borderBottomRightRadius = "9999px";  
            }
            else if (pourcentageRight == 100){
              progresses[1].style.borderTopLeftRadius = "9999px";
              progresses[1].style.borderBottomLeftRadius = "9999px";
            }
            else {
              progresses[0].style.borderTopRightRadius = "0px";
              progresses[0].style.borderBottomRightRadius = "0px";
              progresses[1].style.borderTopLeftRadius = "0px";
              progresses[1].style.borderBottomLeftRadius = "0px";
            }

            progresses[0].style.width = pourcentageLeft + "%";
            progresses[1].style.width = pourcentageRight + "%";
          }
          else if (bar.id == "stats-bar-indel"){

            value.textContent = `${countINDEL[0]} | ${countINDEL[1]}`

            let sumINDEL = (countINDEL.reduce((accumulator, currentValue) => accumulator + currentValue, 0))
            let pourcentageLeft = sumINDEL ? ((countINDEL[0] / sumINDEL) * 100) : 0;
            let pourcentageRight = sumINDEL ? ((countINDEL[1] / sumINDEL) * 100) : 0;
              
            if (pourcentageLeft == 100) {
              progresses[0].style.borderTopRightRadius = "9999px";
              progresses[0].style.borderBottomRightRadius = "9999px";  
            }
            else if (pourcentageRight == 100){
              progresses[1].style.borderTopLeftRadius = "9999px";
              progresses[1].style.borderBottomLeftRadius = "9999px";
            }
            else {
              progresses[0].style.borderTopRightRadius = "0px";
              progresses[0].style.borderBottomRightRadius = "0px";
              progresses[1].style.borderTopLeftRadius = "0px";
              progresses[1].style.borderBottomLeftRadius = "0px";
            }

            progresses[0].style.width = pourcentageLeft + "%";
            progresses[1].style.width = pourcentageRight + "%";
          }
          else if (bar.id == "stats-bar-sv"){

            value.textContent = `${countSV[0]} | ${countSV[1]}`

            let sumSV = (countSV.reduce((accumulator, currentValue) => accumulator + currentValue, 0))
            let pourcentageLeft = sumSV ? ((countSV[0] / sumSV) * 100) : 0;
            let pourcentageRight = sumSV ? ((countSV[1] / sumSV) * 100) : 0;
            
            if (pourcentageLeft == 100) {
              progresses[0].style.borderTopRightRadius = "9999px";
              progresses[0].style.borderBottomRightRadius = "9999px";  
            }
            else if (pourcentageRight == 100){
              progresses[1].style.borderTopLeftRadius = "9999px";
              progresses[1].style.borderBottomLeftRadius = "9999px";
            }
            else {
              progresses[0].style.borderTopRightRadius = "0px";
              progresses[0].style.borderBottomRightRadius = "0px";
              progresses[1].style.borderTopLeftRadius = "0px";
              progresses[1].style.borderBottomLeftRadius = "0px";
            }

            progresses[0].style.width = pourcentageLeft + "%";
            progresses[1].style.width = pourcentageRight + "%";
          }
        })
      }
      function resetFilters() {
          document.querySelector(".search-box .input").value = "";
          document.querySelectorAll(".filter-container-right select").forEach(select => select.value = "ALL");
          document.querySelector(".filter-container-left select").value = "ALL";
          document.querySelectorAll(".error").forEach(error => error.style.display = "none")
          filter();
      }
      function resetFilters() {
          document.querySelector(".search-box .input").value = "";
          document.querySelectorAll(".filter-container-right select").forEach(select => select.value = "ALL");
          document.querySelector(".filter-container-left select").value = "ALL";
          filter();
      }
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        document.getElementById("dropdown-icon").addEventListener("click", show)
        document.getElementById("terminal-icon").addEventListener("click", show)
      });
      function show() {
        if (this.id === "dropdown-icon") {
          element = document.querySelector(".command")
          element.style.display = element.style.display == "none" ? "flex" : "none";
          element = document.querySelectorAll(".popups .popups-container .popup").forEach(popup => popup.style.display = popup.style.display == "none" ? "flex": "none")
        }
        else if (this.id === "terminal-icon") {
          element = document.querySelector(".terminal")
          element.style.display = element.style.display == "none" ? "block" : "none";
        }
      }
    </script>
    <script>
      // Create the loop button element
      const loopButton = document.createElement('button');
      loopButton.className = 'loop-button';
      loopButton.textContent = 'Loop Differences';
      loopButton.title = 'Auto-scroll through differences';
      loopButton.style.position = 'fixed';
      loopButton.style.bottom = '20px';
      loopButton.style.right = '20px';
      loopButton.style.padding = '10px 15px';
      loopButton.style.backgroundColor = '#29903b';
      loopButton.style.color = 'white';
      loopButton.style.border = 'none';
      loopButton.style.borderRadius = '16px';
      loopButton.style.cursor = 'pointer';
      loopButton.style.fontFamily = 'Ubuntu';
      loopButton.style.fontWeight = 'bold';
      loopButton.style.boxShadow = '0 2px 5px rgba(0,0,0,0.2)';
      loopButton.style.zIndex = '999';

      // Add indicator for active/inactive state
      const loopStatusIndicator = document.createElement('span');
      loopStatusIndicator.style.display = 'inline-block';
      loopStatusIndicator.style.width = '10px';
      loopStatusIndicator.style.height = '10px';
      loopStatusIndicator.style.backgroundColor = '#ddd';
      loopStatusIndicator.style.borderRadius = '50%';
      loopStatusIndicator.style.marginRight = '8px';
      loopButton.prepend(loopStatusIndicator);

      // Append button to body
      document.body.appendChild(loopButton);

      // Variables for looping functionality
      let loopActive = false;
      let loopInterval = null;
      let currentDiffIndex = -1;
      let diffElements = [];

      // Function to update diff elements array
      function updateDiffElements() {
          const file1Diffs = Array.from(document.querySelectorAll('.file1-content .diff')).filter(el => el.style.display !== 'none');
          diffElements = file1Diffs;
          console.log(`Found ${diffElements.length} differences`);
          currentDiffIndex = diffElements.length > 0 ? 0 : -1;
      }

      // Function to scroll to specific diff
      function scrollToDiff(index) {
          if (index >= 0 && index < diffElements.length) {
              const diffElement = diffElements[index];
              
              // Scroll both panels to the same position
              const file1Content = document.getElementById('content1');
              const file2Content = document.getElementById('content2');
              
              // Calculate scroll position (center the diff in the viewport)
              const elementTop = diffElement.offsetTop;
              const containerHeight = file1Content.clientHeight;
              const scrollPosition = elementTop - (containerHeight / 2) + (diffElement.clientHeight / 2);
              
              // Smooth scroll to the element
              file1Content.scrollTo({ top: scrollPosition, behavior: 'smooth' });
              file2Content.scrollTo({ top: scrollPosition, behavior: 'smooth' });
              
              // Highlight current difference with a temporary effect
              diffElement.style.transition = 'background-color 0.5s ease';
              const originalColor = diffElement.style.backgroundColor;
              diffElement.style.backgroundColor = 'rgba(255, 165, 0, 0.5)'; // Highlight color
              
              // Reset highlight after a delay
              setTimeout(() => {
                  diffElement.style.backgroundColor = originalColor;
              }, 800);
          }
      }

      // Toggle loop functionality
      function toggleLoop() {
          loopActive = !loopActive;
          
          if (loopActive) {
              // Update indicator to show active state
              loopStatusIndicator.style.backgroundColor = '#ff5722';
              
              // Initialize diff elements and index
              updateDiffElements();
              
              if (diffElements.length > 0) {
                  // Start looping through differences
                  loopInterval = setInterval(() => {
                      scrollToDiff(currentDiffIndex);
                      currentDiffIndex = (currentDiffIndex + 1) % diffElements.length;
                  }, 2000); // Adjust timing as needed
                  
                  // Scroll to first difference immediately
                  scrollToDiff(currentDiffIndex);
              } else {
                  // No differences found
                  alert('No differences found to loop through');
                  loopActive = false;
                  loopStatusIndicator.style.backgroundColor = '#ddd';
              }
          } else {
              // Stop looping
              clearInterval(loopInterval);
              loopStatusIndicator.style.backgroundColor = '#ddd';
          }
      }

      // Add click event to toggle button
      loopButton.addEventListener('click', toggleLoop);

      // Update diff elements when filters change
      document.addEventListener('DOMContentLoaded', function() {
          const filterElements = [
              document.querySelector(".search-box .input"),
              ...document.querySelectorAll(".filter-container-right select")
          ];
          
          filterElements.forEach(element => {
              if (element) {
                  element.addEventListener("change", function() {
                      // If loop is active, restart it to account for new filter
                      if (loopActive) {
                          clearInterval(loopInterval);
                          updateDiffElements();
                          
                          if (diffElements.length > 0) {
                              loopInterval = setInterval(() => {
                                  scrollToDiff(currentDiffIndex);
                                  currentDiffIndex = (currentDiffIndex + 1) % diffElements.length;
                              }, 2000);
                              
                              scrollToDiff(currentDiffIndex);
                          } else {
                              alert('No differences found with current filters');
                              loopActive = false;
                              loopStatusIndicator.style.backgroundColor = '#ddd';
                              toggleLoop(); // Turn off the loop
                          }
                      }
                  });
              }
          });
          
          // Also update when reset button is clicked
          const resetButton = document.querySelector(".reset-button");
          if (resetButton) {
              resetButton.addEventListener("click", function() {
                  setTimeout(updateDiffElements, 100); // Small delay to ensure filters are reset
              });
          }
      });

      // Add keyboard shortcut for toggling loop (press 'L')
      document.addEventListener('keydown', function(event) {
          if (event.key.toLowerCase() === 'l') {
              toggleLoop();
          }
      });

      // Add metrics counter to show progress
      const metricsContainer = document.createElement('div');
      metricsContainer.className = 'loop-metrics';
      metricsContainer.style.position = 'fixed';
      metricsContainer.style.bottom = '70px';
      metricsContainer.style.right = '20px';
      metricsContainer.style.padding = '5px 10px';
      metricsContainer.style.backgroundColor = 'rgba(0,0,0,0.7)';
      metricsContainer.style.color = 'white';
      metricsContainer.style.borderRadius = '5px';
      metricsContainer.style.fontFamily = 'Ubuntu';
      metricsContainer.style.fontSize = '12px';
      metricsContainer.style.display = 'none';
      metricsContainer.style.zIndex = '998';
      document.body.appendChild(metricsContainer);

      // Show metrics when loop is active
      function updateMetrics() {
          if (loopActive) {
              metricsContainer.style.display = 'block';
              metricsContainer.textContent = `Showing difference ${currentDiffIndex + 1} of ${diffElements.length}`;
          } else {
              metricsContainer.style.display = 'none';
          }
      }

      // Update the toggle function to call updateMetrics
      const originalToggleLoop = toggleLoop;
      toggleLoop = function() {
          originalToggleLoop();
          updateMetrics();
      };

      // Update metrics when scrolling to a diff
      const originalScrollToDiff = scrollToDiff;
      scrollToDiff = function(index) {
          originalScrollToDiff(index);
          updateMetrics();
      };
    </script>
</body>
</html>